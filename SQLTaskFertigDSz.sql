Sziasztok,

A lenti dump.sql-t kellene importálni és azonnal lesznek táblák és adatok, amikkel lehet dolgozni. Hozzatok létre neki egy külön adatbázist.

Emlékeztetőül, az importálás módja: mysql -u username -p database_name < /path/to/dump.sql

Két táblából áll:

db__partners (id, name, contact) - partnerek, akiknek dolgoztunk (cégnév és elérhetőség)
db__income (id, partner, amount, project, created, approved) - bevételek: melyik partner, mekkora összeg, a project megnevezése, kezdés időpontja, majd a lezárás/kifizetés időpontja (ha kifizették - egyébként NULL)
Az alábbi feladatokhoz kellene SQL kéréseket megfogalmazni:
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Melyik volt az utolsó 3 projekt, amin a 25-ös partnerrel együtt dolgoztunk?

SELECT * FROM db__income WHERE partner = 25 AND created > 2023-06-19 ORDER BY created DESC LIMIT 3;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Hány projektünk volt 2020-ban, amit a 2-es partner számára kiviteleztünk?

SELECT COUNT(partner) FROM db__income WHERE partner = 2 AND created > '2020-01-01 00:00:00' AND created < '2020-12-31:00:00:00';
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Melyik volt a 10 legnagyobb bevételt hozó projekt? (lássuk a partner nevét, az összeget és a projektet)

SELECT db__partners.name, amount, project 
FROM db__income JOIN db__partners 
ON db__income.partner = db__partners.id 
ORDER BY db__income.amount DESC LIMIT 10;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Melyek az aktuális kintlévőségek? (azok a sorok, ahol az "approved" még NULL értékű)

SELECT * FROM db__income WHERE approved IS NULL;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Mennyi a teljes kintlévőség? (az "amount" összege a kintlévőségeknél)

SELECT SUM(amount) FROM db__income WHERE approved IS NULL;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Melyek a 2022 eleje óta létrejött kifizetett "java" projektek? (ahol az "approved" nem üres és a "project" arra végződik, hogy "java")

SELECT * FROM db__income WHERE approved IS NOT NULL AND created > '2022-01-01 00:00:00' AND project LIKE '% java';
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Melyik partner mennyi feladattal bízott meg minket a 2022-es évben? (partner neve és projektek száma)

SELECT db__partners.name, COUNT(*) as project_counter 
FROM db__income 
JOIN db__partners 
ON db__income.partner = db__partners.id 
WHERE YEAR(created) = 2022 GROUP BY partner;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
Melyek azok a 2022 előtti projektek, amelyeknél szervert állítottunk be? (arra végződik, hogy " server" - az "observer"-re végződőek nem ilyenek)
értesítenünk kell az illetékeseket: lássuk a kapcsolódó partner elérhetőségét
minden partnert csak egyszer lássunk, de legyen mellette, hány ilyen projekt kapcsolódik hozzá
a rekordokat rendezzünk ezem darabszám szerint csökkenő sorrendbe (legelső az legyen, akinél a legtöbb szerver vár karbantartásra)

SELECT db__partners.name, db__partners.contact, COUNT(*) AS project_count
FROM db__partners
JOIN db__income ON db__partners.id = db__income.partner
WHERE YEAR(db__income.created) < 2022 AND db__income.project LIKE '% server' AND db__income.project NOT LIKE '% observer'
GROUP BY db__partners.id, db__partners.name, db__partners.contact
ORDER BY project_count DESC;
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////